<html>
<head>
<title>time_calculator.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #a9b7c6;}
.s1 { color: #6a8759;}
.s2 { color: #6897bb;}
.s3 { color: #cc7832;}
</style>
</head>
<body bgcolor="#2b2b2b">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
time_calculator.py</font>
</center></td></tr></table>
<pre><span class="s0">day_map = {</span>
    <span class="s1">&quot;Monday&quot;</span><span class="s0">: </span><span class="s2">0</span><span class="s3">,</span>
    <span class="s1">&quot;Tuesday&quot;</span><span class="s0">: </span><span class="s2">1</span><span class="s3">,</span>
    <span class="s1">&quot;Wednesday&quot;</span><span class="s0">: </span><span class="s2">2</span><span class="s3">,</span>
    <span class="s1">&quot;Thursday&quot;</span><span class="s0">: </span><span class="s2">3</span><span class="s3">,</span>
    <span class="s1">&quot;Friday&quot;</span><span class="s0">: </span><span class="s2">4</span><span class="s3">,</span>
    <span class="s1">&quot;Saturday&quot;</span><span class="s0">: </span><span class="s2">5</span><span class="s3">,</span>
    <span class="s1">&quot;Sunday&quot;</span><span class="s0">: </span><span class="s2">6</span><span class="s3">,</span>
<span class="s0">}</span>

<span class="s0">week_days = {</span>
    <span class="s2">0</span><span class="s0">: </span><span class="s1">&quot;Monday&quot;</span><span class="s3">,</span>
    <span class="s2">1</span><span class="s0">: </span><span class="s1">&quot;Tuesday&quot;</span><span class="s3">,</span>
    <span class="s2">2</span><span class="s0">: </span><span class="s1">&quot;Wednesday&quot;</span><span class="s3">,</span>
    <span class="s2">3</span><span class="s0">: </span><span class="s1">&quot;Thursday&quot;</span><span class="s3">,</span>
    <span class="s2">4</span><span class="s0">: </span><span class="s1">&quot;Friday&quot;</span><span class="s3">,</span>
    <span class="s2">5</span><span class="s0">: </span><span class="s1">&quot;Saturday&quot;</span><span class="s3">,</span>
    <span class="s2">6</span><span class="s0">: </span><span class="s1">&quot;Sunday&quot;</span><span class="s3">,</span>
<span class="s0">}</span>


<span class="s3">def </span><span class="s0">add_time(start</span><span class="s3">, </span><span class="s0">duration</span><span class="s3">, </span><span class="s0">day=</span><span class="s1">&quot;&quot;</span><span class="s0">):</span>
    <span class="s0">[h</span><span class="s3">, </span><span class="s0">m] = parse_time(start)</span>
    <span class="s0">[ah</span><span class="s3">, </span><span class="s0">am] = parse_duration(duration)</span>
    <span class="s0">m += am</span>
    <span class="s0">h += ah</span>
    <span class="s3">if </span><span class="s0">m &gt; </span><span class="s2">60</span><span class="s0">:</span>
        <span class="s0">m %= </span><span class="s2">60</span>
        <span class="s0">h += </span><span class="s2">1</span>
    <span class="s0">indicator = </span><span class="s1">&quot;AM&quot;</span>

    <span class="s0">n = h // </span><span class="s2">24</span>
    <span class="s3">if </span><span class="s0">h &gt; </span><span class="s2">24</span><span class="s0">:</span>
        <span class="s0">h %= </span><span class="s2">24</span>

    <span class="s3">if </span><span class="s0">h &gt; </span><span class="s2">12</span><span class="s0">:</span>
        <span class="s0">h %= </span><span class="s2">12</span>
        <span class="s0">indicator = </span><span class="s1">&quot;PM&quot;</span>

    <span class="s3">if </span><span class="s0">h == </span><span class="s2">12</span><span class="s0">:</span>
        <span class="s0">indicator = </span><span class="s1">&quot;PM&quot;</span>

    <span class="s3">if </span><span class="s0">h == </span><span class="s2">0</span><span class="s0">:</span>
        <span class="s0">h = </span><span class="s2">12</span>
        <span class="s0">indicator = </span><span class="s1">&quot;AM&quot;</span>

    <span class="s3">if </span><span class="s0">day == </span><span class="s1">&quot;&quot;</span><span class="s0">:</span>
        <span class="s3">if </span><span class="s0">n == </span><span class="s2">0</span><span class="s0">:</span>
            <span class="s3">return </span><span class="s1">&quot;{}:{:02d} {}&quot;</span><span class="s0">.format(h</span><span class="s3">, </span><span class="s0">m</span><span class="s3">, </span><span class="s0">indicator)</span>
        <span class="s3">if </span><span class="s0">n == </span><span class="s2">1</span><span class="s0">:</span>
            <span class="s3">return </span><span class="s1">&quot;{}:{:02d} {} (next day)&quot;</span><span class="s0">.format(h</span><span class="s3">, </span><span class="s0">m</span><span class="s3">, </span><span class="s0">indicator)</span>

        <span class="s3">return </span><span class="s1">&quot;{}:{:02d} {} ({} days later)&quot;</span><span class="s0">.format(h</span><span class="s3">, </span><span class="s0">m</span><span class="s3">, </span><span class="s0">indicator</span><span class="s3">, </span><span class="s0">n)</span>
    <span class="s3">else</span><span class="s0">:</span>
        <span class="s0">day = day.lower()</span>
        <span class="s0">day = day[</span><span class="s2">0</span><span class="s0">].upper() + day[</span><span class="s2">1</span><span class="s0">:]</span>
        <span class="s0">end_day = week_days[(day_map[day] + n) % </span><span class="s2">7</span><span class="s0">]</span>
        <span class="s3">if </span><span class="s0">n == </span><span class="s2">0</span><span class="s0">:</span>
            <span class="s3">return </span><span class="s1">&quot;{}:{:02d} {}, {}&quot;</span><span class="s0">.format(h</span><span class="s3">, </span><span class="s0">m</span><span class="s3">, </span><span class="s0">indicator</span><span class="s3">, </span><span class="s0">end_day)</span>
        <span class="s3">if </span><span class="s0">n == </span><span class="s2">1</span><span class="s0">:</span>
            <span class="s3">return </span><span class="s1">&quot;{}:{:02d} {}, {} (next day)&quot;</span><span class="s0">.format(h</span><span class="s3">, </span><span class="s0">m</span><span class="s3">, </span><span class="s0">indicator</span><span class="s3">, </span><span class="s0">end_day)</span>

        <span class="s3">return </span><span class="s1">&quot;{}:{:02d} {}, {} ({} days later)&quot;</span><span class="s0">.format(h</span><span class="s3">, </span><span class="s0">m</span><span class="s3">, </span><span class="s0">indicator</span><span class="s3">, </span><span class="s0">end_day</span><span class="s3">, </span><span class="s0">n)</span>


<span class="s3">def </span><span class="s0">parse_time(t):</span>
    <span class="s0">[hm</span><span class="s3">, </span><span class="s0">am] = t.split()</span>
    <span class="s0">[h</span><span class="s3">, </span><span class="s0">m] = parse_duration(hm)</span>
    <span class="s3">if </span><span class="s0">am != </span><span class="s1">'AM'</span><span class="s0">:</span>
        <span class="s0">h += </span><span class="s2">12</span>
    <span class="s3">return </span><span class="s0">[h</span><span class="s3">, </span><span class="s0">m]</span>


<span class="s3">def </span><span class="s0">parse_duration(d):</span>
    <span class="s3">return </span><span class="s0">map(</span><span class="s3">lambda </span><span class="s0">s: int(s)</span><span class="s3">, </span><span class="s0">d.split(</span><span class="s1">&quot;:&quot;</span><span class="s0">))</span></pre>
</body>
</html>